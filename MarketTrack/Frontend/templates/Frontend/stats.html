{% extends 'Frontend/base.html' %}
{% load static %}

{% block content %}

{% if request.user.is_anonymous%}
<div class='row p-5 text-center'>
  <p class='color_supp'>Looks like you're not logged in, log in or create an
    account to track your items view item statistics/p>
</div>

{% else %}

<div class="row" id="stats_info_display">

  <div class="col-md-4 ml-4">
    <h4 class="color_supp">View your tracked Item Statistics</h4>
  </div>

</div>

<div class="row mt-3">

  <div class="col-md-6 text-right">

    <form class="d-flex" id="selectionForm_1">
      <div class="form-row align-items-center">
        <div class="col-auto my-1 selection_wrapper">
          <label class="mr-sm-2" for="tracked_select_1">Select a tracked
            item</label>
          <select class="custom-select mr-sm-2" id="tracked_select_1">
            <option selected>--</option>
          </select>
        </div>
      </div>
      <button class="btn stats_button btn-secondary" id="stats_button_1">View
        Stats
      </button>
    </form>
  </div>

  <div class="col-md-6 d-flex justify-content-end text-right">
    <form class=" d-flex" id="selectionForm_2">
      <div class="form-row align-items-center">
        <div class="col-auto my-1 selection_wrapper">
          <label class="mr-sm-2" for="tracked_select_2">Select a tracked
            item</label>
          <select class="custom-select mr-sm-2" id="tracked_select_2">
            <option selected>--</option>
          </select>
        </div>
      </div>
      <button class="btn stats_button btn-secondary" id="stats_button_1">View
        Stats
      </button>
    </form>
  </div>


</div>


<div class="row mt-5" id="char_display">
  <div class="col-md-6">
    <canvas class="stats_chart" id="chart_1">

    </canvas>
  </div>
  <div clas="col-md-6">
    <canvas class="stats_chart" id="chart_2">

    </canvas>
  </div>

</div>


<script>
  let token = "{{csrf_token}}"
  let page = "stats"
  let getTracked_api = "{% url 'getTracked_api' %}"
</script>

<script>
  var dataset_1 = [100, 100, 105, 100, 97, 100, 100]
  var labels = ["18:37 04 May, 2021", "19:07 04 May, 2021", "19:37 04 May, 2021", "20:07 04 May, 2021", "20:37 04 May, 2021"]
  var ctx = $("#chart_1")
  var myChart = new Chart(ctx, {
    type: 'line',
    data: {
      labels: labels,
      datasets: [{
        label: 'Price in GBP',
        data: dataset_1,
        backgroundColor: [
          'rgba(255, 99, 132, 0.2)',
        ],
        borderColor: [
          'rgba(255, 99, 132, 1)',
        ],
        borderWidth: 1
      }
      ]
    },
    options:
    {
      maintainAspectRatio: false,
    }
  });
</script>

<script src="{% static 'Frontend/scripts/stats_ajax_requests.js'%}"></script>

{% endif %}


{% endblock content %}