{% extends 'Frontend/base.html' %}
{% load static %}

{% block content %}

{% if request.user.is_anonymous%}
<div class='row p-5 d-flex justify-content-center'>
  <p class='color_supp'>Looks like you're not logged in, log in or create an
    account to track your items view item statistics</p>
</div>

{% else %}

<div class="row" id="stats_info_display">

  <div class="col-md ml-4">
    <h4 class="color_supp">View your tracked Item Statistics</h4>
  </div>

</div>

<div class="row mt-3">

  <div class="col-md-6 d-flex justify-content-center text-right">

    <form class="d-flex" id="selectionForm_1">
      <div class="form-row align-items-center">
        <div class="col-auto my-1 selection_wrapper">
          <label class="mr-sm-2" for="tracked_select_1">Select a tracked
            item</label>
          <select class="custom-select mr-sm-2" id="tracked_select_1">
            <option selected>--</option>
          </select>
        </div>
      </div>
      <a class="btn stats_button btn-secondary" id="stats_button_1">View
        Stats
      </a>
    </form>
  </div>

  <div class="col-md-6 d-flex justify-content-center text-right">
    <form class=" d-flex" id="selectionForm_2">
      <div class="form-row align-items-center">
        <div class="col-auto my-1 selection_wrapper">
          <label class="mr-sm-2" for="tracked_select_2">Select a tracked
            item</label>
          <select class="custom-select mr-sm-2" id="tracked_select_2">
            <option selected>--</option>
          </select>
        </div>
      </div>
      <a class="btn stats_button btn-secondary" id="stats_button_2">View
        Stats
      </a>
    </form>
  </div>


</div>


<div class="row mt-5" id="char_display">
  <div class="col-md-6 chart-container">
    <canvas class="stats_chart" id="chart_1">

    </canvas>
  </div>

  <div class="col-md-6 chart-container">
    <canvas class="stats_chart" id="chart_2">

    </canvas>
  </div>

</div>


<script>
  let token = "{{csrf_token}}"
  let page = "stats"
  let getTracked_api = "{% url 'getTracked_api' %}"
  let getItemDataset_api = "{% url 'getItemDataset_api' 0 %}"
</script>

<script>
  var dataset_1 = []
  var labels = []

  var ctx1 = $("#chart_1")
  var chart1 = new Chart(ctx1, {
    type: 'line',
    data: {
      labels: labels,
      datasets: [{
        label: 'Price in GBP',
        data: dataset_1,
        backgroundColor: [
          'rgba(255, 99, 132, 0.2)',
        ],
        borderColor: [
          'rgba(255, 99, 132, 1)',
        ],
        borderWidth: 1
      }
      ]
    },
    options:
    {
      maintainAspectRatio: false,
    },
    plugins: {
      title: {
        display: true,
        text: 'Custom Chart Title'
      }
    }
  });

  var ctx2 = $("#chart_2")
  var chart2 = new Chart(ctx2, {
    type: 'line',
    data: {
      labels: labels,
      datasets: [{
        label: 'Price in GBP',
        data: dataset_1,
        backgroundColor: [
          'rgba(255, 99, 132, 0.2)',
        ],
        borderColor: [
          'rgba(255, 99, 132, 1)',
        ],
        borderWidth: 1
      }
      ]
    },
    options:
    {
      maintainAspectRatio: false,
    }
  });

</script>

<script src="{% static 'Frontend/scripts/stats_ajax_requests.js'%}"></script>

{% endif %}


{% endblock content %}